<!DOCTYPE html>
<html lang="zh-TW"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™¾é½¡é«˜ä¸­å­¸ç”Ÿè‡ªæ²»å…¬å…±è³‡è¨Šå¹³å°</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #0f172a; 
            --accent: #2563eb; 
            --success: #16a34a; 
            --danger: #dc2626; 
            --warning: #f59e0b;
            --bg-body: #f8fafc;
            --text-main: #334155;
            --border: #e2e8f0;
            --shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Noto Sans TC', sans-serif; scroll-behavior: smooth; }
        body { background-color: var(--bg-body); color: var(--text-main); line-height: 1.6; padding-bottom: 120px; } /* å¢åŠ åº•éƒ¨é–“è·ä»¥å…è¢«ç®¡ç†åˆ—æ“‹ä½ */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }

        /* --- ç®¡ç†æ¨¡å¼æ¨£å¼ --- */
        body.is-admin .can-edit { outline: 2px dashed var(--accent); background: #fffbeb; border-radius: 4px; cursor: text; min-width: 10px; }
        body.is-admin .can-edit:focus { outline: 2px solid var(--success); background: #ffffff; }
        .admin-only { display: none !important; }
        body.is-admin .admin-only { display: inline-flex !important; }
        
        body:not(.is-admin) .btn-red[onclick*="remove"] { display: none; }

        /* å°èˆª */
        nav { position: fixed; top: 0; width: 100%; z-index: 1000; background: rgba(255,255,255,0.95); backdrop-filter: blur(8px); border-bottom: 3px solid var(--accent); padding: 12px 0; }
        .nav-content { display: flex; justify-content: space-between; align-items: center; position: relative; }
        .nav-brand { font-weight: 900; font-size: 1.3rem; color: var(--primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70%; }
        
        /* æ‰‹æ©Ÿç‰ˆé¸å–®æŒ‰éˆ• */
        .menu-toggle { display: none; font-size: 1.5rem; cursor: pointer; color: var(--primary); }

        .nav-links { display: flex; gap: 20px; list-style: none; }
        .nav-links a { text-decoration: none; color: var(--primary); font-weight: 700; transition: 0.2s; white-space: nowrap; }
        .nav-links a:hover { color: var(--accent); }

        section { padding: 60px 0; border-bottom: 1px solid var(--border); background: white; }
        .section-title { text-align: center; margin-bottom: 40px; }
        .section-title h2 { font-size: 2rem; font-weight: 900; color: var(--primary); line-height: 1.3; }

        /* 1. çµ„ç¹”æ¶æ§‹ */
        .org-wrapper { display: flex; flex-direction: column; align-items: center; padding: 20px 0; width: 100%; }
        .org-row { display: flex; gap: 30px; justify-content: center; width: 100%; flex-wrap: wrap; }
        .org-group { display:flex; flex-direction:column; gap:15px; flex: 1; min-width: 250px; max-width: 300px; }
        .org-card { background: white; border: 1px solid var(--border); border-radius: 12px; padding: 20px; width: 100%; text-align: center; box-shadow: var(--shadow); cursor: pointer; transition: 0.3s; position: relative; }
        .org-card:hover { transform: translateY(-5px); border-color: var(--accent); }
        .org-card strong { display: block; font-size: 1.1rem; color: var(--primary); margin-top: 5px; }
        .org-card small { font-size: 0.75rem; color: #64748b; font-weight: bold; text-transform: uppercase; }

        /* 2. æœƒè­°èˆ‡æŠ•ç¥¨ */
        /* ä¿®æ”¹ minmax ç‚º 280px ä»¥é©æ‡‰æ‰‹æ©Ÿ */
        .meeting-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .meeting-card { padding: 25px; background: #fff; border-radius: 16px; border: 1px solid var(--border); box-shadow: var(--shadow); border-left: 5px solid var(--accent); display: flex; flex-direction: column; }
        .vote-box { background: #f1f5f9; padding: 15px; border-radius: 10px; margin-top: 15px; }
        .vote-inputs { display: flex; justify-content: space-between; font-weight: bold; margin-bottom: 8px; font-size: 0.85rem; flex-wrap: wrap; gap: 5px; }
        .vote-num { color: var(--accent); border-bottom: 1px dashed #94a3b8; min-width: 20px; display: inline-block; text-align: center; }
        .progress-bar { display: flex; height: 12px; border-radius: 6px; overflow: hidden; background: #e2e8f0; }
        .bar-segment { height: 100%; transition: width 0.5s ease; }
        
        /* é™„ä»¶æ¨£å¼ */
        .file-list { margin-top: 15px; border-top: 1px dashed #e2e8f0; padding-top: 10px; }
        .file-tag { display: inline-flex; align-items: center; gap: 5px; background: #f1f5f9; color: #475569; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; text-decoration: none; margin-right: 5px; margin-bottom: 5px; border: 1px solid #cbd5e1; transition: 0.2s; max-width: 100%; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .file-tag:hover { background: #e2e8f0; color: var(--accent); }

        /* 3. æ³•æ¡ˆè¡¨æ ¼ - éŸ¿æ‡‰å¼è™•ç† */
        .table-responsive { overflow-x: auto; -webkit-overflow-scrolling: touch; margin-top: 20px; box-shadow: var(--shadow); border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; background: white; min-width: 600px; /* ç¢ºä¿è¡¨æ ¼åœ¨æ‰‹æ©Ÿä¸Šæœ‰è¶³å¤ å¯¬åº¦ */ }
        th { background: #f8fafc; color: var(--primary); font-weight: 900; white-space: nowrap; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid #eee; vertical-align: top; }
        .status-badge { padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; display: inline-block; white-space: nowrap; }

        /* 4. åæ˜ å€ */
        .feedback-area { background: linear-gradient(135deg, #eff6ff 0%, #ffffff 100%); border-radius: 20px; padding: 30px; text-align: center; border: 1px solid #dbeafe; }
        .feedback-guide { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; text-align: left; }
        .guide-card { background: white; padding: 20px; border-radius: 12px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        
        /* 5. ç®¡ç†é¢æ¿ */
        .admin-dock { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 9999; display: flex; align-items: center; gap: 10px; background: #1e293b; padding: 10px 20px; border-radius: 50px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1); width: max-content; max-width: 95%; flex-wrap: wrap; justify-content: center; }
        .btn { padding: 8px 16px; border-radius: 50px; border: none; font-weight: 700; cursor: pointer; display: inline-flex; align-items: center; gap: 6px; font-size: 0.85rem; transition: 0.2s; color: white; text-decoration: none; white-space: nowrap; }
        .btn:hover { transform: translateY(-2px); filter: brightness(1.1); }
        .btn-blue { background: var(--accent); }
        .btn-red { background: var(--danger); }
        .btn-green { background: var(--success); }
        .btn-gray { background: #64748b; }
        .btn-light { background: #e2e8f0; color: #334155; }
        .btn-light:hover { background: #cbd5e1; }

        /* å½ˆçª— */
        .overlay { position: fixed; inset: 0; background: rgba(15,23,42,0.9); z-index: 10000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(4px); padding: 20px; }
        .modal { background: white; padding: 30px; border-radius: 20px; width: 100%; max-width: 450px; text-align: center; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); max-height: 90vh; overflow-y: auto; }
        .modal input { width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem; }
        
        .admin-list-item { display: flex; justify-content: space-between; align-items: center; background: #f1f5f9; padding: 10px; border-radius: 8px; margin-bottom: 8px; }
        
        /* --- RWD Media Queries --- */
        @media (max-width: 768px) {
            /* å°èˆª */
            .menu-toggle { display: block; }
            .nav-links { 
                position: absolute; top: 100%; left: 0; width: 100%; 
                background: white; flex-direction: column; align-items: center; 
                padding: 20px 0; gap: 20px; 
                border-bottom: 2px solid var(--border); box-shadow: 0 10px 15px rgba(0,0,0,0.05);
                display: none; /* é è¨­éš±è— */
            }
            .nav-links.active { display: flex; } /* JS åˆ‡æ›é¡¯ç¤º */

            /* çµ„ç¹” */
            .org-row { flex-direction: column; align-items: center; }
            .org-group { width: 100%; max-width: 100%; }

            /* æœƒè­°å¡ç‰‡ */
            .meeting-grid { grid-template-columns: 1fr; }

            /* ææ¡ˆå€ */
            .feedback-guide { grid-template-columns: 1fr; }
            .feedback-area { padding: 20px 15px; }

            /* ç®¡ç†å€ */
            .admin-dock { width: 90%; padding: 12px; border-radius: 15px; flex-direction: row; justify-content: space-around; }
            .btn { flex: 1; justify-content: center; padding: 10px; font-size: 0.8rem; }
            .admin-dock .btn i { margin-right: 0; } /* æ‰‹æ©Ÿç‰ˆå¦‚æœæŒ‰éˆ•å¤ªæ“ ï¼Œå¯é¸æ“‡éš±è—æ–‡å­—ï¼Œç›®å‰ä¿ç•™ */
        }
    </style>
</head>
<body onload="init()" class="">

    <div id="db-admins" style="display:none;">[{"u":"s11311092","p":"JA6300010"}]</div>

    <nav>
        <div class="container nav-content">
            <div class="nav-brand can-edit">ç™¾é½¡é«˜ä¸­ç­ç´šä»£è¡¨å¤§æœƒ</div>
            <div class="menu-toggle" onclick="toggleMenu()"><i class="fa-solid fa-bars"></i></div>
            <ul class="nav-links" id="navLinks">
                <li><a href="#org" onclick="toggleMenu()">çµ„ç¹”</a></li>
                <li><a href="#meetings" onclick="toggleMenu()">è­°äº‹</a></li>
                <li><a href="#bills" onclick="toggleMenu()">æ³•æ¡ˆ</a></li>
                <li><a href="#feedback" onclick="toggleMenu()">ææ¡ˆ</a></li>
            </ul>
        </div>
    </nav>

    <section id="org">
        <div class="container">
            <div class="section-title">
                <h2 class="can-edit">ğŸ›ï¸ å­¸ç”Ÿè‡ªæ²»çµ„ç¹”æ¶æ§‹</h2>
                <p class="can-edit">ä¸‰æ¬Šåˆ†ç«‹ï¼šç«‹æ³•ã€è¡Œæ”¿ã€å¸æ³•äº’ç›¸åˆ¶è¡¡</p>
            </div>
            <div class="org-wrapper">
                <div class="org-row">
                    <div class="org-group">
                        <div class="org-card" style="border-top:5px solid #64748b" onclick="showInfo('leg')">
                            <small class="can-edit">ç«‹æ³•æ©Ÿé—œ</small><strong class="can-edit">ç­ç´šä»£è¡¨å¤§æœƒ</strong>
                        </div>
                        <div class="org-card" onclick="showInfo('leg-leader')">
                            <small class="can-edit">è­°æœƒé¦–é•·</small><strong class="can-edit">è­°é•· / å‰¯è­°é•·</strong>
                        </div>
                        <div class="org-card" style="background:#fffbeb; border: 1px dashed var(--warning)" onclick="showInfo('leg-sec')">
                            <small class="can-edit">å¹•åƒšå–®ä½</small><strong class="can-edit">å¤§æœƒç§˜æ›¸è™•</strong>
                        </div>
                    </div>
                    <div class="org-group">
                        <div class="org-card" style="border-top:5px solid var(--accent)" onclick="showInfo('exe')">
                            <small class="can-edit">è¡Œæ”¿æ©Ÿé—œ</small><strong class="can-edit">ç­è¯æœƒ</strong>
                        </div>
                        <div class="org-card" onclick="showInfo('exe-leader')">
                            <small class="can-edit">è¡Œæ”¿é¦–é•·</small><strong class="can-edit">ä¸»å¸­ / å‰¯ä¸»å¸­</strong>
                        </div>
                        <div class="org-card" onclick="showInfo('exe-dept')">
                            <small class="can-edit">è¡Œæ”¿éƒ¨é–€</small><strong class="can-edit">å­¸æ¬ŠåŠè¡Œæ”¿äº”çµ„</strong>
                        </div>
                    </div>
                    <div class="org-group">
                        <div class="org-card" style="border-top:5px solid #94a3b8" onclick="showInfo('jud')">
                            <small class="can-edit">å¸æ³•æ©Ÿé—œ</small><strong class="can-edit">è§£é‡‹å§”å“¡æœƒ</strong>
                        </div>
                        <div class="org-card" onclick="showInfo('jud-comm')">
                            <small class="can-edit">å¸æ³•å®˜</small><strong class="can-edit">å¸æ³•å§”å“¡</strong>
                        </div>
                        <div class="org-card" style="border: 2px solid var(--success)" onclick="showInfo('jud-ele')">
                            <small class="can-edit">ç¨ç«‹é¸å‹™</small><strong class="can-edit">é¸èˆ‰å§”å“¡æœƒ</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="meetings">
        <div class="container">
            <div class="section-title"><h2 class="can-edit">ğŸ“… è­°äº‹èˆ‡æŠ•ç¥¨ç´€éŒ„</h2></div>
            <button class="btn btn-blue admin-only" onclick="addMeeting()" style="margin-bottom:20px;">
                <i class="fa-solid fa-plus"></i> æ–°å¢æœƒè­°ç´€éŒ„
            </button>
            <div class="meeting-grid" id="meetingGrid">
                <div class="meeting-card">
                    <h3 class="can-edit">ç­è¯æœƒçµ„ç¹”ç« ç¨‹ç¬¬åå››æ¢å»¢æ­¢æ¡ˆ</h3>
                    <p style="margin:10px 0;">ğŸ“ åœ°é»ï¼š<span class="can-edit">ä¸‰æ¨“æœƒè­°å®¤</span></p>
                    <p>â° æ™‚é–“ï¼š<span class="can-edit">2025/10/15</span></p>
                    <div class="vote-box">
                        <div class="vote-inputs"><span style="color:var(--success)">è´Šæˆ <span class="vote-num can-edit v-pro" oninput="calcVotes(this)">50</span></span><span style="color:var(--danger)">åå° <span class="vote-num can-edit v-con" oninput="calcVotes(this)">0</span></span><span style="color:#64748b">æ£„æ¬Š <span class="vote-num can-edit v-abs" oninput="calcVotes(this)">3</span></span></div>
                        <div class="progress-bar"><div class="bar-segment bar-pro" style="width: 94%; background: var(--success);"></div><div class="bar-segment bar-con" style="width: 0%; background: var(--danger);"></div><div class="bar-segment bar-abs" style="width: 6%; background: rgb(148, 163, 184);"></div></div>
                        <div style="text-align:right; font-size:0.8rem; margin-top:5px; color:#64748b;">å³æ™‚æ¯”ä¾‹ï¼š<span class="p-pro">94</span>% / <span class="p-con">0</span>% / <span class="p-abs">6</span>%</div>
                    </div>
                    <div class="file-list"><small style="display:block; color:#94a3b8; margin-bottom:5px;">ğŸ“‚ ç›¸é—œæœƒè­°è³‡æ–™ï¼š</small><div class="files-container"></div><button class="btn-light admin-only" style="margin-top:10px; padding:5px 15px; font-size:0.8rem;" onclick="addFile(this, 'meeting')"><i class="fa-solid fa-paperclip"></i> æ–°å¢é™„ä»¶é€£çµ</button></div>
                    <button class="btn-red admin-only" style="margin-top:15px; width:100%; justify-content:center;" onclick="this.closest('.meeting-card').remove()">åˆªé™¤ç´€éŒ„</button>
                </div>
                <div class="meeting-card">
                    <h3 class="can-edit">ç­è¯æœƒçµ„ç¹”ç« ç¨‹ç¬¬äºŒåä¸ƒæ¢ç¬¬å››é …å»¢æ­¢æ¡ˆ</h3>
                    <p style="margin:10px 0;">ğŸ“ åœ°é»ï¼š<span class="can-edit">ä¸‰æ¨“æœƒè­°å®¤</span></p>
                    <p>â° æ™‚é–“ï¼š<span class="can-edit">2025/10/15</span></p>
                    <div class="vote-box">
                        <div class="vote-inputs"><span style="color:var(--success)">è´Šæˆ <span class="vote-num can-edit v-pro" oninput="calcVotes(this)">47</span></span><span style="color:var(--danger)">åå° <span class="vote-num can-edit v-con" oninput="calcVotes(this)">2</span></span><span style="color:#64748b">æ£„æ¬Š <span class="vote-num can-edit v-abs" oninput="calcVotes(this)">5</span></span></div>
                        <div class="progress-bar"><div class="bar-segment bar-pro" style="width: 87%; background: var(--success);"></div><div class="bar-segment bar-con" style="width: 4%; background: var(--danger);"></div><div class="bar-segment bar-abs" style="width: 9%; background: rgb(148, 163, 184);"></div></div>
                        <div style="text-align:right; font-size:0.8rem; margin-top:5px; color:#64748b;">å³æ™‚æ¯”ä¾‹ï¼š<span class="p-pro">87</span>% / <span class="p-con">4</span>% / <span class="p-abs">9</span>%</div>
                    </div>
                    <div class="file-list"><small style="display:block; color:#94a3b8; margin-bottom:5px;">ğŸ“‚ ç›¸é—œæœƒè­°è³‡æ–™ï¼š</small><div class="files-container"></div><button class="btn-light admin-only" style="margin-top:10px; padding:5px 15px; font-size:0.8rem;" onclick="addFile(this, 'meeting')"><i class="fa-solid fa-paperclip"></i> æ–°å¢é™„ä»¶é€£çµ</button></div>
                    <button class="btn-red admin-only" style="margin-top:15px; width:100%; justify-content:center;" onclick="this.closest('.meeting-card').remove()">åˆªé™¤ç´€éŒ„</button>
                </div>
            <div class="meeting-card"><h3 class="can-edit is-admin"><h3 class="can-edit">ç­è¯æœƒçµ„ç¹”ç« ç¨‹ç¬¬ä¸‰åæ¢ä¿®æ­£æ¡ˆ</h3></h3><p style="margin:10px 0;">ğŸ“ åœ°é»ï¼š<span class="can-edit is-admin">ä¸‰æ¨“æœƒè­°å®¤</span></p><p>â° æ™‚é–“ï¼š<span class="can-edit is-admin">2025/10/15</span></p><div class="vote-box"><div class="vote-inputs"><span style="color:var(--success)">è´Šæˆ <span class="vote-num can-edit v-pro" oninput="calcVotes(this)">44</span></span><span style="color:var(--danger)">åå° <span class="vote-num can-edit v-con" oninput="calcVotes(this)">0</span></span><span style="color:#64748b">æ£„æ¬Š <span class="vote-num can-edit v-abs" oninput="calcVotes(this)">10</span></span></div><div class="progress-bar"><div class="bar-segment bar-pro" style="width: 81%; background: var(--success);"></div><div class="bar-segment bar-con" style="width: 0%; background: var(--danger);"></div><div class="bar-segment bar-abs" style="width: 19%; background: rgb(148, 163, 184);"></div></div><div style="text-align:right; font-size:0.8rem; margin-top:5px; color:#64748b;">å³æ™‚æ¯”ä¾‹ï¼š<span class="p-pro">81</span>% / <span class="p-con">0</span>% / <span class="p-abs">19</span>%</div></div><div class="file-list"><small style="display:block; color:#94a3b8; margin-bottom:5px;">ğŸ“‚ ç›¸é—œæœƒè­°è³‡æ–™ï¼š</small><div class="files-container"></div><button class="btn-light admin-only" style="margin-top:10px; padding:5px 15px; font-size:0.8rem;" onclick="addFile(this, 'meeting')"><i class="fa-solid fa-paperclip"></i> æ–°å¢é™„ä»¶é€£çµ</button></div><button class="btn-red admin-only" style="margin-top:15px; width:100%; justify-content:center;" onclick="this.closest('.meeting-card').remove()">åˆªé™¤ç´€éŒ„</button></div><div class="meeting-card"><h3 class="can-edit is-admin"><h3 class="can-edit">ç­è¯æœƒçµ„ç¹”ç« ç¨‹ç¬¬å››åäºŒæ¢ä¿®æ­£æ¡ˆ</h3></h3><p style="margin:10px 0;">ğŸ“ åœ°é»ï¼š<span class="can-edit is-admin">ä¸‰æ¨“æœƒè­°å®¤</span></p><p>â° æ™‚é–“ï¼š<span class="can-edit is-admin">2025/10/15</span></p><div class="vote-box"><div class="vote-inputs"><span style="color:var(--success)">è´Šæˆ <span class="vote-num can-edit v-pro" oninput="calcVotes(this)">49</span></span><span style="color:var(--danger)">åå° <span class="vote-num can-edit v-con" oninput="calcVotes(this)">0</span></span><span style="color:#64748b">æ£„æ¬Š <span class="vote-num can-edit v-abs" oninput="calcVotes(this)">6</span></span></div><div class="progress-bar"><div class="bar-segment bar-pro" style="width: 89%; background: var(--success);"></div><div class="bar-segment bar-con" style="width: 0%; background: var(--danger);"></div><div class="bar-segment bar-abs" style="width: 11%; background: rgb(148, 163, 184);"></div></div><div style="text-align:right; font-size:0.8rem; margin-top:5px; color:#64748b;">å³æ™‚æ¯”ä¾‹ï¼š<span class="p-pro">89</span>% / <span class="p-con">0</span>% / <span class="p-abs">11</span>%</div></div><div class="file-list"><small style="display:block; color:#94a3b8; margin-bottom:5px;">ğŸ“‚ ç›¸é—œæœƒè­°è³‡æ–™ï¼š</small><div class="files-container"></div><button class="btn-light admin-only" style="margin-top:10px; padding:5px 15px; font-size:0.8rem;" onclick="addFile(this, 'meeting')"><i class="fa-solid fa-paperclip"></i> æ–°å¢é™„ä»¶é€£çµ</button></div><button class="btn-red admin-only" style="margin-top:15px; width:100%; justify-content:center;" onclick="this.closest('.meeting-card').remove()">åˆªé™¤ç´€éŒ„</button></div></div>
        </div>
    </section>

    <section id="bills" style="background:#f8fafc;">
        <div class="container">
            <div class="section-title"><h2 class="can-edit">ğŸ“‹ æ³•æ¡ˆç®¡ç†å°ˆå€</h2></div>
            <button class="btn btn-blue admin-only" onclick="openModal('billModal')" style="margin-bottom:15px;">
                <i class="fa-solid fa-folder-plus"></i> æ–°å¢æ³•æ¡ˆ
            </button>
            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th class="can-edit" style="width:15%">æ¡ˆè™Ÿ</th>
                            <th class="can-edit" style="width:30%">æ³•æ¡ˆæ¨™é¡Œ</th>
                            <th class="can-edit" style="width:15%">ææ¡ˆå–®ä½</th>
                            <th class="can-edit" style="width:15%">ç›®å‰ç‹€æ…‹</th>
                            <th style="width:25%">ç›¸é—œæ–‡ä»¶</th>
                            <th class="admin-only">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="billBody">
                        <tr>
                            <td class="can-edit">114-2-1</td>
                            <td class="can-edit">ç¾è¡Œç­è¯æ³•å»¢é™¤</td>
                            <td class="can-edit">å¼µæ³°éˆ ä»£è¡¨</td>
                            <td><span class="status-badge can-edit" style="background:#ddd;">ææ¡ˆ</span></td>
                            <td>
                                <div class="files-container"><a href="https://drive.google.com/file/d/1QFW0VFcZX3Evua7mXJJNNwHBUoNqKCM-/view?usp=sharing" target="_blank" class="file-tag"><i class="fa-regular fa-file"></i> ææ¡ˆç†ç”±æ›¸</a></div>
                                <button class="btn-light admin-only" style="margin-top:5px; padding:2px 8px; font-size:0.7rem;" onclick="addFile(this, 'bill')"><i class="fa-solid fa-plus"></i> é€£çµ</button>
                            </td>
                            <td class="admin-only"><button class="btn-red" style="padding:5px 10px;" onclick="this.closest('tr').remove()">åˆªé™¤</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <section id="feedback">
        <div class="container">
            <div class="feedback-area">
                <h2 class="can-edit" style="margin-bottom:20px; font-size:1.8rem; font-weight:900;">ğŸ’¬ ææ¡ˆèˆ‡æ„è¦‹åæ˜ </h2>
                <p class="can-edit" style="color:#64748b; margin-bottom:30px;">è«‹å…ˆé–±è®€ä¸‹æ–¹è² è²¬å–®ä½èªªæ˜ï¼Œå†é»æ“ŠæŒ‰éˆ•å¡«å¯«è¡¨å–®ã€‚</p>
                <div class="feedback-guide">
                    <div class="guide-card" style="border-left: 4px solid #64748b;">
                        <h4><i class="fa-solid fa-scale-balanced"></i> ç«‹æ³•ææ¡ˆ</h4>
                        <p style="font-size:0.85rem; margin-bottom:10px; font-weight:bold;">è² è²¬å–®ä½ï¼šç­ä»£å¤§æœƒ</p>
                        <ul><li>æ ¡è¦ã€è‡ªæ²»æ¢ä¾‹ä¿®æ­£</li><li>é ç®—æ¡ˆå¯©æŸ¥èˆ‡å»ºè­°</li><li>ç›£ç£è¡Œæ”¿éƒ¨é–€æ–½æ”¿</li></ul>
                    </div>
                    <div class="guide-card" style="border-left: 4px solid var(--accent);">
                        <h4><i class="fa-solid fa-bullhorn"></i> è¡Œæ”¿æ¬Šç›Š</h4>
                        <p style="font-size:0.85rem; margin-bottom:10px; font-weight:bold;">è² è²¬å–®ä½ï¼šç­è¯æœƒ</p>
                        <ul><li>æ¬Šç›Šå—æç”³è¨´ (å­¸æ¬Š)</li><li>æ ¡åœ’è¨­æ–½å ±ä¿®èˆ‡å»ºè­°</li><li>æ´»å‹•èˆ‰è¾¦å»ºè­°</li></ul>
                    </div>
                    <div class="guide-card" style="border-left: 4px solid #94a3b8;">
                        <h4><i class="fa-solid fa-gavel"></i> å¸æ³•é‡‹æ†²</h4>
                        <p style="font-size:0.85rem; margin-bottom:10px; font-weight:bold;">è² è²¬å–®ä½ï¼šè§£é‡‹å§”å“¡æœƒ</p>
                        <ul><li>æ³•è¦ç–‘ç¾©è§£é‡‹</li><li>è‡ªæ²»æ³•è¦é•æ†²å¯©æŸ¥</li><li>é¸èˆ‰ç³¾ç´›ä»²è£</li></ul>
                    </div>
                </div>
                <div style="margin-top:30px;">
                    <a href="https://forms.gle/5ymGZKDaAyriEBubA" target="_blank" class="btn btn-blue can-edit" style="padding: 15px 30px; font-size: 1rem; width:100%; max-width:300px; justify-content:center;">
                        <i class="fa-solid fa-pen-to-square"></i> é»æ­¤å¡«å¯«ç·šä¸Šææ¡ˆå–®
                    </a>
                </div>
            </div>
        </div>
    </section>

    <div class="admin-dock">
        <button id="loginBtn" class="btn btn-blue" onclick="openModal('loginModal')" style="display: flex;"><i class="fa-solid fa-user-gear"></i> ç®¡ç†ç™»å…¥</button>
        <button class="btn btn-gray admin-only" onclick="openAdminManager()"><i class="fa-solid fa-users-gear"></i> è¨­å®š</button>
        <button class="btn btn-green admin-only" onclick="exportHTML()"><i class="fa-solid fa-download"></i> å„²å­˜</button>
        <button class="btn btn-red admin-only" onclick="logout()"><i class="fa-solid fa-right-from-bracket"></i> ç™»å‡º</button>
    </div>

    <div id="loginModal" class="overlay" style="display: none;">
        <div class="modal">
            <h3 style="margin-bottom:15px; font-size:1.5rem;">å¾Œå°æ¬Šé™é©—è­‰</h3>
            <input type="text" id="uid" placeholder="è«‹è¼¸å…¥å¸³è™Ÿ">
            <input type="password" id="pwd" placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-blue" style="flex:1; justify-content:center;" onclick="login()">ç™»å…¥</button>
                <button class="btn btn-red" style="flex:1; justify-content:center;" onclick="closeModal('loginModal')">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <div id="adminManagerModal" class="overlay" style="display: none;">
        <div class="modal">
            <h3>ç®¡ç†å“¡å¸³è™Ÿè¨­å®š</h3>
            <p style="color:#64748b; font-size:0.9rem; margin-bottom:15px;">è®Šæ›´å¾Œè«‹å‹™å¿…ä¸‹è¼‰æ–°æª”æ¡ˆã€‚</p>
            <div id="adminListContainer" style="margin-bottom:20px; text-align:left;"></div>
            <hr style="margin:15px 0; border:0; border-top:1px solid #e2e8f0;">
            <h4 style="margin-bottom:10px;">æ–°å¢ç®¡ç†å“¡</h4>
            <input type="text" id="newAdminId" placeholder="æ–°å¸³è™Ÿ">
            <input type="password" id="newAdminPwd" placeholder="æ–°å¯†ç¢¼">
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-green" style="flex:1; justify-content:center;" onclick="addAdmin()">æ–°å¢</button>
                <button class="btn btn-gray" style="flex:1; justify-content:center;" onclick="closeModal('adminManagerModal')">é—œé–‰</button>
            </div>
        </div>
    </div>

    <div id="fileModal" class="overlay" style="display: none;">
        <div class="modal">
            <h3>æ–°å¢æ–‡ä»¶é€£çµ</h3>
            <input type="text" id="fileName" placeholder="é¡¯ç¤ºåç¨±">
            <input type="text" id="fileUrl" placeholder="é€£çµç¶²å€">
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-blue" style="flex:1; justify-content:center;" onclick="confirmAddFile()">åŠ å…¥</button>
                <button class="btn btn-gray" style="flex:1; justify-content:center;" onclick="closeModal('fileModal')">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <div id="billModal" class="overlay" style="display: none;">
        <div class="modal">
            <h3>æ–°å¢æ³•æ¡ˆ</h3>
            <input type="text" id="bNo" placeholder="æ¡ˆè™Ÿ (ä¾‹: 113-A-01)">
            <input type="text" id="bTitle" placeholder="æ³•æ¡ˆåç¨±">
            <input type="text" id="bDept" placeholder="ææ¡ˆå–®ä½">
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-blue" style="flex:1; justify-content:center;" onclick="addBill()">ç¢ºèª</button>
                <button class="btn btn-gray" style="flex:1; justify-content:center; background:#cbd5e1;" onclick="closeModal('billModal')">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <div id="infoModal" class="overlay" onclick="closeModal('infoModal')" style="display: none;">
        <div class="modal" onclick="event.stopPropagation()">
            <h2 id="infoTitle" style="color:var(--accent); margin-bottom:10px;"></h2>
            <hr style="border:0; border-top:1px solid #eee; margin:10px 0;">
            <p id="infoDesc" style="text-align:left; line-height:1.8; color:#475569; margin-top:15px;"></p>
            <button class="btn btn-blue" style="width:100%; justify-content:center; margin-top:20px;" onclick="closeModal('infoModal')">é—œé–‰</button>
        </div>
    </div>

    <script>
        let ADMIN_DB = [];
        let currentFileTarget = null;
        
        // è©³ç´°ç‰ˆçµ„ç¹”ä»‹ç´¹è³‡æ–™
        const INFO_DB = {
            'leg': 'ç­ä»£å¤§æœƒï¼šæœ€é«˜æ°‘æ„æ©Ÿé—œï¼Œç”±å…¨æ ¡ç­ä»£çµ„æˆï¼Œå¯©è­°æ³•è¦èˆ‡é ç®—ã€‚',
            'leg-leader': '<b>è­°é•·ã€å‰¯è­°é•·</b><br>ä¸»æŒç­ç´šä»£è¡¨å¤§æœƒå„é …æœƒè­°ï¼Œç¶­æŒè­°äº‹ç¨‹åºä¹‹æ­£ç•¶èˆ‡ç§©åºï¼Œç¢ºä¿è¨è«–ç†æ€§é€²è¡Œèˆ‡è¡¨æ±ºçµæœå…·åˆæ³•æ€§ï¼Œä¸¦ä»£è¡¨ç«‹æ³•æ©Ÿé—œå°å¤–ç™¼è²ã€‚',
            'leg-sec': '<b>ç§˜æ›¸è™•</b><br>è² è²¬æœƒå‹™çµ±æ•´èˆ‡è¡Œæ”¿åº¶å‹™è¦åŠƒï¼Œå½™æ•´å„é …æœƒè­°è³‡æ–™èˆ‡æ±ºè­°äº‹é …ï¼Œè¿½è¹¤æ”¿ç­–åŸ·è¡Œé€²åº¦ï¼Œç¶­æŒçµ„ç¹”å…§éƒ¨è³‡è¨Šæµé€šèˆ‡åˆ¶åº¦é‹ä½œé †æš¢ã€‚',
            'exe': 'ç­è¯æœƒï¼šæœ€é«˜è¡Œæ”¿æ©Ÿé—œï¼Œæ¨å‹•å­¸ç”Ÿç¦åˆ©èˆ‡è¾¦ç†å…¨æ ¡æ€§æ´»å‹•ã€‚',
            'exe-leader': '<b>ç­è¯æœƒä¸»å¸­</b><br>ç¶œç†å­¸ç”Ÿè‡ªæ²»è¡Œæ”¿äº‹å‹™ï¼Œçµ±ç±Œæ”¿ç­–è¦åŠƒèˆ‡åŸ·è¡Œï¼Œæ•´åˆå„çµ„è³‡æºï¼Œæ¨å‹•æ ¡åœ’å…¬å…±äº‹å‹™ç™¼å±•ï¼Œä¸¦ä»£è¡¨è¡Œæ”¿é«”ç³»å°å…§å”èª¿ã€å°å¤–æºé€šã€‚<br><br><b>ç­è¯æœƒå‰¯ä¸»å¸­</b><br>è¥„åŠ©ä¸»å¸­ç£å°å„çµ„æ¥­å‹™é‹ä½œï¼Œå¼·åŒ–è·¨çµ„å”èª¿èˆ‡è¡Œæ”¿æ•ˆç‡ï¼Œæ–¼ä¸»å¸­ç„¡æ³•è¡Œä½¿è·æ¬Šæ™‚ä¾æ³•ä»£ç†å…¶è·å‹™ï¼Œç¢ºä¿è¡Œæ”¿é‹ä½œä¸ä¸­æ–·ã€‚',
            'exe-dept': '<b>å­¸æ¬Šçµ„</b><br>å°ˆè²¬å­¸ç”Ÿæ¬Šç›Šä¿éšœèˆ‡åˆ¶åº¦ç›£ç£ï¼Œå—ç†æ¬Šç›Šé™³æƒ…ï¼Œç ”æ“¬ä¿®æ³•å»ºè­°ï¼Œæ¨å‹•æ ¡åœ’åˆ¶åº¦å„ªåŒ–ï¼Œè‡´åŠ›è½å¯¦ç¨‹åºæ­£ç¾©èˆ‡å­¸ç”Ÿåƒèˆ‡æ¬Šã€‚<br><br><b>æ–‡æ›¸çµ„</b><br>è² è²¬æœƒè­°ç´€éŒ„æ’°å¯«ã€å…¬æ–‡å¾€è¿”èˆ‡è³‡æ–™æ•´ç†å­˜æª”ï¼Œå»ºæ§‹å®Œæ•´åˆ¶åº¦æª”æ¡ˆï¼Œä½¿çµ„ç¹”æ±ºç­–éç¨‹å…·å¯è¿½æº¯æ€§èˆ‡åˆ¶åº¦è¨˜æ†¶ã€‚<br><br><b>å…¬é—œçµ„</b><br>çµ±ç±Œå°å¤–è¯ç¹«èˆ‡å®£å‚³äº‹å‹™ï¼Œç¶“ç‡Ÿåª’é«”èˆ‡ç¤¾ç¾¤å¹³å°ï¼Œå¼·åŒ–å­¸ç”Ÿè‡ªæ²»å½¢è±¡ï¼Œä¿ƒé€²æ ¡å…§å¤–æºé€šèˆ‡å…¬å…±ç†è§£ã€‚<br><br><b>æ´»å‹•çµ„</b><br>è¦åŠƒä¸¦åŸ·è¡Œæ ¡å…§å¤–å„é …æ´»å‹•ï¼Œçµ±ç±Œè³‡æºé…ç½®èˆ‡æµç¨‹å®‰æ’ï¼Œå…¼é¡§å‰µæ„èˆ‡ç§©åºï¼Œæå‡å­¸ç”Ÿåƒèˆ‡åº¦èˆ‡æ ¡åœ’å‡èšåŠ›ã€‚<br><br><b>è³‡è¨Šçµ„</b><br>ç®¡ç†å®˜æ–¹å¸³è™Ÿï¼Œå»ºæ§‹å³æ™‚ä¸”æœ‰æ•ˆç‡çš„è³‡è¨Šå‚³éç³»çµ±ã€‚(ç›®å‰å·²ç”±ç¶²ç®¡å–ä»£)<br><br><b>æ©Ÿå‹•çµ„</b><br>æ”¯æ´å ´åœ°å¸ƒç½®ã€å™¨æèª¿åº¦èˆ‡è‡¨æ™‚ä»»å‹™åŸ·è¡Œï¼Œç¶­æŒæ´»å‹•ç¾å ´ç§©åºèˆ‡å®‰å…¨ï¼Œä½œç‚ºå„çµ„å³æ™‚æ”¯æ´ä¹‹å¾Œå‹¤åŠ›é‡ã€‚',
            'jud': 'è§£é‡‹å§”å“¡æœƒï¼šæœ€é«˜å¸æ³•æ©Ÿé—œï¼Œè§£é‡‹æ³•è¦ç–‘ç¾©ä¸¦è§£æ±ºæ¬Šé™è¡çªã€‚',
            'jud-comm': '<b>å¸æ³•å¬é›†äºº</b><br>çµ±ç±Œè§£é‡‹å§”å“¡æœƒæœƒè­°èˆ‡æ¡ˆä»¶åˆ†é…ï¼Œå”èª¿å§”å“¡å¯©è­°æµç¨‹ï¼Œç¢ºä¿å¸æ³•å¯©ç†ä¹‹ç¨ç«‹æ€§èˆ‡ç¨‹åºå®Œæ•´æ€§ã€‚<br><br><b>å¸æ³•å§”å“¡</b><br>è² è²¬ç« ç¨‹è§£é‡‹èˆ‡çˆ­è­°æ¡ˆä»¶å¯©ç†ï¼Œä¾ç¨‹åºé€²è¡Œèª¿æŸ¥èˆ‡è£æ±ºï¼Œä¿éšœå­¸ç”Ÿæ¬Šç›Šèˆ‡åˆ¶åº¦æ¬Šå¨ï¼Œç¶­è­·è‡ªæ²»é«”åˆ¶ä¹‹æ³•ç§©åºã€‚',
            'jud-ele': '<b>é¸èˆ‰å§”å“¡æœƒ</b><br>ä¾æ³•è¾¦ç†å­¸ç”Ÿè‡ªæ²»å„é …é¸èˆ‰äº‹å‹™ï¼Œè² è²¬å€™é¸è³‡æ ¼å¯©æŸ¥ã€é¸å‹™è¦åŠƒèˆ‡æŠ•é–‹ç¥¨ä½œæ¥­ï¼Œç¢ºä¿é¸èˆ‰å…¬å¹³ã€å…¬æ­£ã€å…¬é–‹ã€‚'
        };

        function init() {
            const dbContent = document.getElementById('db-admins').innerText;
            try { ADMIN_DB = JSON.parse(dbContent); } catch(e) { ADMIN_DB = [{u:'s11311092', p:'JA6300010'}]; }
        }

        // æ‰‹æ©Ÿé¸å–®åˆ‡æ›
        function toggleMenu() {
            document.getElementById('navLinks').classList.toggle('active');
        }

        function login() {
            const u = document.getElementById('uid').value;
            const p = document.getElementById('pwd').value;
            if(ADMIN_DB.some(admin => admin.u === u && admin.p === p)) {
                document.body.classList.add('is-admin');
                toggleEditable(true);
                document.getElementById('loginBtn').style.display = 'none';
                closeModal('loginModal');
                document.getElementById('uid').value = ''; document.getElementById('pwd').value = '';
                alert('âœ… ç®¡ç†æ¨¡å¼å·²é–‹å•Ÿ');
            } else { alert('âŒ å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤'); }
        }

        function logout() {
            if(confirm('ç¢ºå®šè¦é€€å‡ºç®¡ç†æ¨¡å¼å—ï¼Ÿæœªä¸‹è¼‰çš„è®Šæ›´å°‡æœƒéºå¤±ã€‚')) {
                document.body.classList.remove('is-admin');
                toggleEditable(false);
                document.getElementById('loginBtn').style.display = 'flex';
                alert('ğŸ”’ å·²å›åˆ°è¨ªå®¢è¦–è§’');
            }
        }

        function toggleEditable(isEditable) {
            document.querySelectorAll('.can-edit').forEach(el => {
                if(el.parentElement.tagName !== 'H3') {
                    el.contentEditable = isEditable;
                }
            });
            document.querySelectorAll('h3.can-edit').forEach(h3 => {
               h3.contentEditable = isEditable;
            });
        }

        function showInfo(key) {
            if(document.body.classList.contains('is-admin')) return;
            document.getElementById('infoTitle').innerHTML = document.querySelector(`[onclick="showInfo('${key}')"] strong`).innerHTML;
            document.getElementById('infoDesc').innerHTML = INFO_DB[key] || 'è©³æƒ…è«‹è¦‹å­¸ç”Ÿè‡ªæ²»æ³•ã€‚';
            openModal('infoModal');
        }

        function openModal(id) { document.getElementById(id).style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        // --- ç®¡ç†å“¡è¨­å®š ---
        function openAdminManager() { renderAdminList(); openModal('adminManagerModal'); }
        function renderAdminList() {
            const container = document.getElementById('adminListContainer');
            container.innerHTML = '';
            ADMIN_DB.forEach((admin, index) => {
                const item = document.createElement('div');
                item.className = 'admin-list-item';
                item.innerHTML = `<span><i class="fa-solid fa-user"></i> ${admin.u}</span><button class="btn-red" style="padding: 5px 10px; font-size: 0.8rem;" onclick="removeAdmin(${index})">åˆªé™¤</button>`;
                container.appendChild(item);
            });
        }
        function addAdmin() {
            const u = document.getElementById('newAdminId').value.trim();
            const p = document.getElementById('newAdminPwd').value.trim();
            if(!u || !p) { alert('è«‹è¼¸å…¥å®Œæ•´'); return; }
            if(ADMIN_DB.some(a => a.u === u)) { alert('å¸³è™Ÿå·²å­˜åœ¨'); return; }
            ADMIN_DB.push({u: u, p: p});
            updateDbElement(); renderAdminList();
            document.getElementById('newAdminId').value = ''; document.getElementById('newAdminPwd').value = '';
        }
        function removeAdmin(index) {
            if(ADMIN_DB.length <= 1) { alert('è‡³å°‘ä¿ç•™ä¸€å€‹'); return; }
            if(confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) { ADMIN_DB.splice(index, 1); updateDbElement(); renderAdminList(); }
        }
        function updateDbElement() { document.getElementById('db-admins').innerText = JSON.stringify(ADMIN_DB); }

        // --- æŠ•ç¥¨è¨ˆç®— ---
        function calcVotes(el) {
            const card = el.closest('.meeting-card');
            const pro = parseInt(card.querySelector('.v-pro').innerText) || 0;
            const con = parseInt(card.querySelector('.v-con').innerText) || 0;
            const abs = parseInt(card.querySelector('.v-abs').innerText) || 0;
            const total = pro + con + abs;
            if (total > 0) {
                const pp = Math.round((pro/total)*100), pc = Math.round((con/total)*100), pa = 100 - pp - pc;
                card.querySelector('.bar-pro').style.width = pp + '%'; card.querySelector('.bar-con').style.width = pc + '%'; card.querySelector('.bar-abs').style.width = pa + '%';
                card.querySelector('.p-pro').innerText = pp; card.querySelector('.p-con').innerText = pc; card.querySelector('.p-abs').innerText = pa;
            }
        }

        // --- æ–°å¢é …ç›® ---
        function addBill() {
            const no = document.getElementById('bNo').value;
            const title = document.getElementById('bTitle').value;
            const dept = document.getElementById('bDept').value;
            const html = `<tr><td class="can-edit is-admin">${no}</td><td class="can-edit is-admin">${title}</td><td class="can-edit is-admin">${dept}</td><td><span class="status-badge can-edit is-admin" style="background:#ddd;">è‰æ¡ˆ</span></td><td><div class="files-container"></div><button class="btn-light admin-only" style="margin-top:5px; padding:2px 8px; font-size:0.7rem;" onclick="addFile(this, 'bill')"><i class="fa-solid fa-plus"></i> é€£çµ</button></td><td class="admin-only"><button class="btn-red" style="padding:5px 10px;" onclick="this.closest('tr').remove()">åˆªé™¤</button></td></tr>`;
            document.getElementById('billBody').insertAdjacentHTML('beforeend', html);
            if(document.body.classList.contains('is-admin')) toggleEditable(true);
            closeModal('billModal');
        }

        function addMeeting() {
            const html = `<div class="meeting-card"><h3 class="can-edit is-admin">æ–°æœƒè­°ä¸»é¡Œ</h3><p style="margin:10px 0;">ğŸ“ åœ°é»ï¼š<span class="can-edit is-admin">å¾…å®š</span></p><p>â° æ™‚é–“ï¼š<span class="can-edit is-admin">å¾…å®š</span></p><div class="vote-box"><div class="vote-inputs"><span style="color:var(--success)">è´Šæˆ <span class="vote-num can-edit v-pro" oninput="calcVotes(this)">0</span></span><span style="color:var(--danger)">åå° <span class="vote-num can-edit v-con" oninput="calcVotes(this)">0</span></span><span style="color:#64748b">æ£„æ¬Š <span class="vote-num can-edit v-abs" oninput="calcVotes(this)">0</span></span></div><div class="progress-bar"><div class="bar-segment bar-pro" style="width:0; background:var(--success)"></div><div class="bar-segment bar-con" style="width:0; background:var(--danger)"></div><div class="bar-segment bar-abs" style="width:0; background:#94a3b8"></div></div><div style="text-align:right; font-size:0.8rem; margin-top:5px; color:#64748b;">å³æ™‚æ¯”ä¾‹ï¼š<span class="p-pro">0</span>% / <span class="p-con">0</span>% / <span class="p-abs">0</span>%</div></div><div class="file-list"><small style="display:block; color:#94a3b8; margin-bottom:5px;">ğŸ“‚ ç›¸é—œæœƒè­°è³‡æ–™ï¼š</small><div class="files-container"></div><button class="btn-light admin-only" style="margin-top:10px; padding:5px 15px; font-size:0.8rem;" onclick="addFile(this, 'meeting')"><i class="fa-solid fa-paperclip"></i> æ–°å¢é™„ä»¶é€£çµ</button></div><button class="btn-red admin-only" style="margin-top:15px; width:100%; justify-content:center;" onclick="this.closest('.meeting-card').remove()">åˆªé™¤ç´€éŒ„</button></div>`;
            document.getElementById('meetingGrid').insertAdjacentHTML('beforeend', html);
            if(document.body.classList.contains('is-admin')) toggleEditable(true);
        }

        // --- æª”æ¡ˆé€£çµè™•ç† ---
        function addFile(btn, type) {
            currentFileTarget = btn.previousElementSibling; 
            document.getElementById('fileName').value = '';
            document.getElementById('fileUrl').value = '';
            openModal('fileModal');
        }

        function confirmAddFile() {
            const name = document.getElementById('fileName').value || 'æ–‡ä»¶';
            let url = document.getElementById('fileUrl').value || '#';
            if(url !== '#' && !url.startsWith('http')) url = 'https://' + url;

            const fileHTML = `<a href="${url}" target="_blank" class="file-tag"><i class="fa-regular fa-file"></i> ${name}</a>`;
            if(currentFileTarget) currentFileTarget.insertAdjacentHTML('beforeend', fileHTML);
            closeModal('fileModal');
        }

        // --- è¼¸å‡º ---
        function exportHTML() {
            updateDbElement();
            let clone = document.documentElement.cloneNode(true);
            clone.querySelectorAll('.overlay').forEach(e => e.style.display = 'none');
            // æ¸…ç†æ‰‹æ©Ÿç‰ˆå°èˆªç‹€æ…‹
            clone.querySelector('.nav-links').classList.remove('active');

            clone.querySelector('body').classList.remove('is-admin');
            clone.querySelectorAll('[contenteditable]').forEach(e => e.removeAttribute('contenteditable'));
            
            clone.querySelectorAll('h3[style*="outline"]').forEach(h3 => {
               h3.removeAttribute('style');
            });

            if(clone.querySelector('#loginBtn')) clone.querySelector('#loginBtn').style.display = 'flex';
            
            const blob = new Blob(["<!DOCTYPE html>\n" + clone.outerHTML], {type: 'text/html'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'index.html';
            a.click();
            alert('âœ… ç¶²é å·²æ›´æ–°ï¼è«‹å°‡ä¸‹è¼‰çš„ index.html ä¸Šå‚³ã€‚');
        }
    </script>


</body></html>