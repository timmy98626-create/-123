<!DOCTYPE html>
<html lang="zh-TW"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™¾é½¡é«˜ä¸­å­¸ç”Ÿè‡ªæ²»å…¬å…±è³‡è¨Šå¹³å°</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #0f172a; 
            --accent: #2563eb; 
            --success: #16a34a; 
            --danger: #dc2626; 
            --warning: #f59e0b;
            --bg-body: #f8fafc;
            --text-main: #334155;
            --border: #e2e8f0;
            --shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Noto Sans TC', sans-serif; scroll-behavior: smooth; }
        body { background-color: var(--bg-body); color: var(--text-main); line-height: 1.6; padding-bottom: 120px; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }

        /* --- ç®¡ç†æ¨¡å¼æ¨£å¼ --- */
        body.is-admin .can-edit { outline: 2px dashed var(--accent); background: #fffbeb; border-radius: 4px; cursor: text; min-width: 10px; }
        body.is-admin .can-edit:focus { outline: 2px solid var(--success); background: #ffffff; }
        .admin-only { display: none !important; }
        body.is-admin .admin-only { display: inline-flex !important; }
        
        body:not(.is-admin) .btn-red[onclick*="remove"] { display: none; }

        /* ç‰¹æ®Šï¼šæ—¥æœŸå€å¡Šåœ¨ç®¡ç†æ¨¡å¼ä¸‹çš„æ¨£å¼ (è¡¨ç¤ºå¯é»æ“Š) */
        body.is-admin .schedule-date-box { cursor: pointer; transition: 0.2s; position: relative; }
        body.is-admin .schedule-date-box:hover { filter: brightness(1.1); box-shadow: inset 0 0 0 3px var(--warning); }
        body.is-admin .schedule-date-box::after { content: 'é»æ“Šä¿®æ”¹'; position: absolute; bottom: 5px; font-size: 0.6rem; color: rgba(255,255,255,0.8); display: none; }
        body.is-admin .schedule-date-box:hover::after { display: block; }

        /* å°èˆª */
        nav { position: fixed; top: 0; width: 100%; z-index: 1000; background: rgba(255,255,255,0.95); backdrop-filter: blur(8px); border-bottom: 3px solid var(--accent); padding: 12px 0; }
        .nav-content { display: flex; justify-content: space-between; align-items: center; position: relative; }
        .nav-brand { font-weight: 900; font-size: 1.3rem; color: var(--primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70%; }
        
        /* æ‰‹æ©Ÿç‰ˆé¸å–®æŒ‰éˆ• */
        .menu-toggle { display: none; font-size: 1.5rem; cursor: pointer; color: var(--primary); }

        .nav-links { display: flex; gap: 20px; list-style: none; }
        .nav-links a { text-decoration: none; color: var(--primary); font-weight: 700; transition: 0.2s; white-space: nowrap; }
        .nav-links a:hover { color: var(--accent); }

        section { padding: 60px 0; border-bottom: 1px solid var(--border); background: white; }
        .section-title { text-align: center; margin-bottom: 40px; }
        .section-title h2 { font-size: 2rem; font-weight: 900; color: var(--primary); line-height: 1.3; }

        /* 1. çµ„ç¹”æ¶æ§‹ */
        .org-wrapper { display: flex; flex-direction: column; align-items: center; padding: 20px 0; width: 100%; }
        .org-row { display: flex; gap: 30px; justify-content: center; width: 100%; flex-wrap: wrap; }
        .org-group { display:flex; flex-direction:column; gap:15px; flex: 1; min-width: 250px; max-width: 300px; }
        .org-card { background: white; border: 1px solid var(--border); border-radius: 12px; padding: 20px; width: 100%; text-align: center; box-shadow: var(--shadow); cursor: pointer; transition: 0.3s; position: relative; }
        .org-card:hover { transform: translateY(-5px); border-color: var(--accent); }
        .org-card strong { display: block; font-size: 1.1rem; color: var(--primary); margin-top: 5px; }
        .org-card small { font-size: 0.75rem; color: #64748b; font-weight: bold; text-transform: uppercase; }

        /* è­°äº‹æ™‚é–“è¡¨æ¨£å¼ */
        .schedule-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .schedule-card { display: flex; background: white; border-radius: 12px; box-shadow: var(--shadow); border: 1px solid var(--border); overflow: hidden; transition: 0.3s; }
        .schedule-card:hover { transform: translateY(-3px); border-color: var(--accent); }
        .schedule-date-box { background: var(--primary); color: white; padding: 20px 15px; display: flex; flex-direction: column; align-items: center; justify-content: center; min-width: 90px; text-align: center; user-select: none; }
        .date-month { font-size: 0.8rem; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px; }
        .date-day { font-size: 1.8rem; font-weight: 900; line-height: 1.1; }
        .date-weekday { font-size: 0.8rem; margin-top: 5px; background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 10px; }
        .schedule-content { padding: 20px; flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .schedule-info { display: flex; gap: 15px; font-size: 0.85rem; color: #64748b; margin-bottom: 8px; align-items: center; }
        
        /* 2. æœƒè­°èˆ‡æŠ•ç¥¨ */
        .meeting-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .meeting-card { padding: 25px; background: #fff; border-radius: 16px; border: 1px solid var(--border); box-shadow: var(--shadow); border-left: 5px solid var(--accent); display: flex; flex-direction: column; }
        .vote-box { background: #f1f5f9; padding: 15px; border-radius: 10px; margin-top: 15px; }
        .vote-inputs { display: flex; justify-content: space-between; font-weight: bold; margin-bottom: 8px; font-size: 0.85rem; flex-wrap: wrap; gap: 5px; }
        .vote-num { color: var(--accent); border-bottom: 1px dashed #94a3b8; min-width: 20px; display: inline-block; text-align: center; }
        .progress-bar { display: flex; height: 12px; border-radius: 6px; overflow: hidden; background: #e2e8f0; }
        .bar-segment { height: 100%; transition: width 0.5s ease; }
        
        /* é™„ä»¶æ¨£å¼ */
        .file-list { margin-top: 15px; border-top: 1px dashed #e2e8f0; padding-top: 10px; }
        .file-tag { display: inline-flex; align-items: center; gap: 5px; background: #f1f5f9; color: #475569; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; text-decoration: none; margin-right: 5px; margin-bottom: 5px; border: 1px solid #cbd5e1; transition: 0.2s; max-width: 100%; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .file-tag:hover { background: #e2e8f0; color: var(--accent); }

        /* 3. æ³•æ¡ˆè¡¨æ ¼ */
        .table-responsive { overflow-x: auto; -webkit-overflow-scrolling: touch; margin-top: 20px; box-shadow: var(--shadow); border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; background: white; min-width: 600px; }
        th { background: #f8fafc; color: var(--primary); font-weight: 900; white-space: nowrap; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid #eee; vertical-align: top; }
        .status-badge { padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; display: inline-block; white-space: nowrap; }

        /* 4. åæ˜ å€ */
        .feedback-area { background: linear-gradient(135deg, #eff6ff 0%, #ffffff 100%); border-radius: 20px; padding: 30px; text-align: center; border: 1px solid #dbeafe; }
        .feedback-guide { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; text-align: left; }
        .guide-card { background: white; padding: 20px; border-radius: 12px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        
        /* 5. ç®¡ç†é¢æ¿ */
        .admin-dock { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 9999; display: flex; align-items: center; gap: 10px; background: #1e293b; padding: 10px 20px; border-radius: 50px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1); width: max-content; max-width: 95%; flex-wrap: wrap; justify-content: center; }
        .btn { padding: 8px 16px; border-radius: 50px; border: none; font-weight: 700; cursor: pointer; display: inline-flex; align-items: center; gap: 6px; font-size: 0.85rem; transition: 0.2s; color: white; text-decoration: none; white-space: nowrap; }
        .btn:hover { transform: translateY(-2px); filter: brightness(1.1); }
        .btn-blue { background: var(--accent); }
        .btn-red { background: var(--danger); }
        .btn-green { background: var(--success); }
        .btn-gray { background: #64748b; }
        .btn-light { background: #e2e8f0; color: #334155; }
        .btn-light:hover { background: #cbd5e1; }

        /* å½ˆçª— */
        .overlay { position: fixed; inset: 0; background: rgba(15,23,42,0.9); z-index: 10000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(4px); padding: 20px; }
        .modal { background: white; padding: 30px; border-radius: 20px; width: 100%; max-width: 450px; text-align: center; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); max-height: 90vh; overflow-y: auto; }
        .modal input, .modal select { width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem; outline: none; }
        .modal input:focus, .modal select:focus { border-color: var(--accent); }
        
        .admin-list-item { display: flex; justify-content: space-between; align-items: center; background: #f1f5f9; padding: 10px; border-radius: 8px; margin-bottom: 8px; }
        
        /* --- RWD Media Queries --- */
        @media (max-width: 768px) {
            .menu-toggle { display: block; }
            .nav-links { 
                position: absolute; top: 100%; left: 0; width: 100%; 
                background: white; flex-direction: column; align-items: center; 
                padding: 20px 0; gap: 20px; 
                border-bottom: 2px solid var(--border); box-shadow: 0 10px 15px rgba(0,0,0,0.05);
                display: none; 
            }
            .nav-links.active { display: flex; }

            .org-row { flex-direction: column; align-items: center; }
            .org-group { width: 100%; max-width: 100%; }

            .meeting-grid, .schedule-grid { grid-template-columns: 1fr; }
            .schedule-card { flex-direction: row; } 
            
            .feedback-guide { grid-template-columns: 1fr; }
            .feedback-area { padding: 20px 15px; }

            .admin-dock { width: 90%; padding: 12px; border-radius: 15px; flex-direction: row; justify-content: space-around; }
            .btn { flex: 1; justify-content: center; padding: 10px; font-size: 0.8rem; }
            .admin-dock .btn i { margin-right: 0; }
        }
    </style>
</head>
<body onload="init()" class="">

    <div id="db-admins" style="display:none;">[{"u":"s11311092","p":"JA6300010"},{"u":"s123456789","p":"123456789"}]</div>
    <input type="date" id="hiddenDatePicker" style="display:none; position:absolute; z-index:10001;" onchange="applyDateChange(this)">

    <nav>
        <div class="container nav-content">
            <div class="nav-brand">ç™¾é½¡é«˜ä¸­ç­ç´šä»£è¡¨å¤§æœƒ</div>
            <div class="menu-toggle" onclick="toggleMenu()"><i class="fa-solid fa-bars"></i></div>
            <ul class="nav-links" id="navLinks">
                <li><a href="#org" onclick="toggleMenu()">çµ„ç¹”</a></li>
                <li><a href="#schedule" onclick="toggleMenu()">æ™‚é–“è¡¨</a></li>
                <li><a href="#meetings" onclick="toggleMenu()">è­°äº‹</a></li>
                <li><a href="#bills" onclick="toggleMenu()">æ³•æ¡ˆ</a></li>
                <li><a href="#feedback" onclick="toggleMenu()">ææ¡ˆ</a></li>
            </ul>
        </div>
    </nav>

    <section id="org">
        <div class="container">
            <div class="section-title">
                <h2 class="">ğŸ›ï¸ å­¸ç”Ÿè‡ªæ²»çµ„ç¹”æ¶æ§‹</h2>
                <p class="">ä¸‰æ¬Šåˆ†ç«‹ï¼šç«‹æ³•ã€è¡Œæ”¿ã€å¸æ³•äº’ç›¸åˆ¶è¡¡</p>
            </div>
            <div class="org-wrapper">
                <div class="org-row">
                    <div class="org-group">
                        <div class="org-card" style="border-top:5px solid #64748b" onclick="showInfo('leg')">
                            <small class="">ç«‹æ³•æ©Ÿé—œ</small><strong class="">ç­ç´šä»£è¡¨å¤§æœƒ</strong>
                        </div>
                        <div class="org-card" onclick="showInfo('leg-leader')">
                            <small class="">è­°æœƒé¦–é•·</small><strong class="">è­°é•· / å‰¯è­°é•·</strong>
                        </div>
                        <div class="org-card" style="background:#fffbeb; border: 1px dashed var(--warning)" onclick="showInfo('leg-sec')">
                            <small class="">å¹•åƒšå–®ä½</small><strong class="">å¤§æœƒç§˜æ›¸è™•</strong>
                        </div>
                    </div>
                    <div class="org-group">
                        <div class="org-card" style="border-top:5px solid var(--accent)" onclick="showInfo('exe')">
                            <small class="">è¡Œæ”¿æ©Ÿé—œ</small><strong class="">ç­è¯æœƒ</strong>
                        </div>
                        <div class="org-card" onclick="showInfo('exe-leader')">
                            <small class="">è¡Œæ”¿é¦–é•·</small><strong class="">ä¸»å¸­ / å‰¯ä¸»å¸­</strong>
                        </div>
                        <div class="org-card" onclick="showInfo('exe-dept')">
                            <small class="">è¡Œæ”¿éƒ¨é–€</small><strong class="">å­¸æ¬ŠåŠè¡Œæ”¿äº”çµ„</strong>
                        </div>
                    </div>
                    <div class="org-group">
                        <div class="org-card" style="border-top:5px solid #94a3b8" onclick="showInfo('jud')">
                            <small class="">å¸æ³•æ©Ÿé—œ</small><strong class="">è§£é‡‹å§”å“¡æœƒ</strong>
                        </div>
                        <div class="org-card" onclick="showInfo('jud-comm')">
                            <small class="">å¸æ³•å®˜</small><strong class="">å¸æ³•å§”å“¡</strong>
                        </div>
                        <div class="org-card" style="border: 2px solid var(--success)" onclick="showInfo('jud-ele')">
                            <small class="">ç¨ç«‹é¸å‹™</small><strong class="">é¸èˆ‰å§”å“¡æœƒ</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="schedule" style="background:#f1f5f9;">
        <div class="container">
            <div class="section-title">
                <h2 class="">ğŸ—“ï¸ è­°äº‹æ™‚é–“è¡¨</h2>
                <p class="">æŒæ¡æœ€æ–°é–‹æœƒè³‡è¨Šèˆ‡æ´»å‹•æ—¥ç¨‹</p>
            </div>
            <button class="btn btn-blue admin-only" onclick="openScheduleModal()" style="margin-bottom:20px;">
                <i class="fa-solid fa-calendar-plus"></i> æ–°å¢è¡Œç¨‹
            </button>
            <div class="schedule-grid" id="scheduleGrid">
                <div class="schedule-card">
                    <div class="schedule-date-box" onclick="editScheduleDate(this)">
                        <span class="date-month">MAR</span>
                        <span class="date-day">6</span>
                        <span class="date-weekday">é€±äº”</span>
                    </div>
                    <div class="schedule-content">
                        <h3 class="" style="font-size:1.2rem; margin-bottom:5px;">ç­ç´šä»£è¡¨å¤§æœƒ æœŸåˆæœƒè­°</h3>
                        <div class="schedule-info">
                            <span><i class="fa-regular fa-clock"></i> <span class="">15:10~16:00</span></span>
                            <span><i class="fa-solid fa-location-dot"></i> <span class="">5F æœƒè­°å®¤</span></span>
                        </div>
                        <div class="files-container">
                             <a href="#" class="file-tag"><i class="fa-regular fa-bell"></i> é–‹æœƒé€šçŸ¥å–®</a>
                        </div>
                        <button class="btn-light admin-only" style="margin-top:10px; padding:5px 15px; font-size:0.8rem; width:fit-content;" onclick="addFile(this, 'schedule')"><i class="fa-solid fa-link"></i> é€£çµ</button>
                        <button class="btn-red admin-only" style="margin-top:10px; margin-left:10px; padding:5px 15px; font-size:0.8rem; width:fit-content;" onclick="this.closest('.schedule-card').remove()">åˆªé™¤</button>
                    </div>
                </div>
                
                <div class="schedule-card">
                    <div class="schedule-date-box" style="background: var(--accent);" onclick="editScheduleDate(this)">
                        <span class="date-month">MAR</span>
                        <span class="date-day">13</span>
                        <span class="date-weekday">é€±äº”</span>
                    </div>
                    <div class="schedule-content">
                        <h3 class="" style="font-size:1.2rem; margin-bottom:5px;"><h3 class="" style="margin-bottom: 5px; outline: rgb(22, 163, 74) solid 2px; background-color: rgb(255, 255, 255); font-size: 1.2rem;">ç­ç´šä»£è¡¨å¤§æœƒ å®šæœŸå¤§æœƒ</h3></h3>
                        <div class="schedule-info">
                            <span><i class="fa-regular fa-clock"></i> <span class="">15:10~16:00</span></span>
                            <span><i class="fa-solid fa-location-dot"></i> <span class="">3F æœƒè­°å®¤</span></span>
                        </div>
                        <div class="files-container"></div>
                        <button class="btn-light admin-only" style="margin-top:10px; padding:5px 15px; font-size:0.8rem; width:fit-content;" onclick="addFile(this, 'schedule')"><i class="fa-solid fa-link"></i> é€£çµ</button>
                        <button class="btn-red admin-only" style="margin-top:10px; margin-left:10px; padding:5px 15px; font-size:0.8rem; width:fit-content;" onclick="this.closest('.schedule-card').remove()">åˆªé™¤</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="meetings">
        <div class="container">
            <div class="section-title"><h2 class="">ğŸ“… è­°äº‹èˆ‡æŠ•ç¥¨ç´€éŒ„</h2></div>
            <button class="btn btn-blue admin-only" onclick="addMeeting()" style="margin-bottom:20px;">
                <i class="fa-solid fa-plus"></i> æ–°å¢æœƒè­°ç´€éŒ„
            </button>
            <div class="meeting-grid" id="meetingGrid">
                <div class="meeting-card">
                    <h3 class="">ç­è¯æœƒçµ„ç¹”ç« ç¨‹ä¿®æ­£æ¡ˆ</h3>
                    <p style="margin:10px 0;">ğŸ“ åœ°é»ï¼š<span class="">ä¸‰æ¨“æœƒè­°å®¤</span></p>
                    <p>â° æ™‚é–“ï¼š<span class="">2025/10/15</span></p>
                    <div class="vote-box">
                        <div class="vote-inputs"><span style="color:var(--success)">è´Šæˆ <span class="vote-num v-pro" oninput="calcVotes(this)">50</span></span><span style="color:var(--danger)">åå° <span class="vote-num v-con" oninput="calcVotes(this)">0</span></span><span style="color:#64748b">æ£„æ¬Š <span class="vote-num v-abs" oninput="calcVotes(this)">3</span></span></div>
                        <div class="progress-bar"><div class="bar-segment bar-pro" style="width: 94%; background: var(--success);"></div><div class="bar-segment bar-con" style="width: 0%; background: var(--danger);"></div><div class="bar-segment bar-abs" style="width: 6%; background: rgb(148, 163, 184);"></div></div>
                        <div style="text-align:right; font-size:0.8rem; margin-top:5px; color:#64748b;">å³æ™‚æ¯”ä¾‹ï¼š<span class="p-pro">94</span>% / <span class="p-con">0</span>% / <span class="p-abs">6</span>%</div>
                    </div>
                    <div class="file-list"><small style="display:block; color:#94a3b8; margin-bottom:5px;">ğŸ“‚ ç›¸é—œæœƒè­°è³‡æ–™ï¼š</small><div class="files-container"></div><button class="btn-light admin-only" style="margin-top:10px; padding:5px 15px; font-size:0.8rem;" onclick="addFile(this, 'meeting')"><i class="fa-solid fa-paperclip"></i> æ–°å¢é™„ä»¶é€£çµ</button></div>
                    <button class="btn-red admin-only" style="margin-top:15px; width:100%; justify-content:center;" onclick="this.closest('.meeting-card').remove()">åˆªé™¤ç´€éŒ„</button>
                </div>
            </div>
        </div>
    </section>

    <section id="bills" style="background:#f8fafc;">
        <div class="container">
            <div class="section-title"><h2 class="">ğŸ“‹ æ³•æ¡ˆç®¡ç†å°ˆå€</h2></div>
            <button class="btn btn-blue admin-only" onclick="openModal('billModal')" style="margin-bottom:15px;">
                <i class="fa-solid fa-folder-plus"></i> æ–°å¢æ³•æ¡ˆ
            </button>
            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th class="" style="width:15%">æ¡ˆè™Ÿ</th>
                            <th class="" style="width:30%">æ³•æ¡ˆæ¨™é¡Œ</th>
                            <th class="" style="width:15%">ææ¡ˆå–®ä½</th>
                            <th class="" style="width:15%">ç›®å‰ç‹€æ…‹</th>
                            <th style="width:25%">ç›¸é—œæ–‡ä»¶</th>
                            <th class="admin-only">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="billBody">
                        <tr>
                            <td class="">114-2-1</td>
                            <td class="">ç¾è¡Œç­è¯æ³•å»¢é™¤</td>
                            <td class="">å¼µæ³°éˆ ä»£è¡¨</td>
                            <td><span class="status-badge" style="background:#ddd;">ææ¡ˆ</span></td>
                            <td>
                                <div class="files-container"><a href="#" class="file-tag"><i class="fa-regular fa-file"></i> ææ¡ˆç†ç”±æ›¸</a></div>
                                <button class="btn-light admin-only" style="margin-top:5px; padding:2px 8px; font-size:0.7rem;" onclick="addFile(this, 'bill')"><i class="fa-solid fa-plus"></i> é€£çµ</button>
                            </td>
                            <td class="admin-only"><button class="btn-red" style="padding:5px 10px;" onclick="this.closest('tr').remove()">åˆªé™¤</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <section id="feedback">
        <div class="container">
            <div class="feedback-area">
                <h2 class="" style="margin-bottom:20px; font-size:1.8rem; font-weight:900;">ğŸ’¬ ææ¡ˆèˆ‡æ„è¦‹åæ˜ </h2>
                <p class="" style="color:#64748b; margin-bottom:30px;">è«‹å…ˆé–±è®€ä¸‹æ–¹è² è²¬å–®ä½èªªæ˜ï¼Œå†é»æ“ŠæŒ‰éˆ•å¡«å¯«è¡¨å–®ã€‚</p>
                <div class="feedback-guide">
                    <div class="guide-card" style="border-left: 4px solid #64748b;">
                        <h4><i class="fa-solid fa-scale-balanced"></i> ç«‹æ³•ææ¡ˆ</h4>
                        <p style="font-size:0.85rem; margin-bottom:10px; font-weight:bold;">è² è²¬å–®ä½ï¼šç­ä»£å¤§æœƒ</p>
                        <ul><li>æ ¡è¦ã€è‡ªæ²»æ¢ä¾‹ä¿®æ­£</li><li>é ç®—æ¡ˆå¯©æŸ¥èˆ‡å»ºè­°</li><li>ç›£ç£è¡Œæ”¿éƒ¨é–€æ–½æ”¿</li></ul>
                    </div>
                    <div class="guide-card" style="border-left: 4px solid var(--accent);">
                        <h4><i class="fa-solid fa-bullhorn"></i> è¡Œæ”¿æ¬Šç›Š</h4>
                        <p style="font-size:0.85rem; margin-bottom:10px; font-weight:bold;">è² è²¬å–®ä½ï¼šç­è¯æœƒ</p>
                        <ul><li>æ¬Šç›Šå—æç”³è¨´ (å­¸æ¬Š)</li><li>æ ¡åœ’è¨­æ–½å ±ä¿®èˆ‡å»ºè­°</li><li>æ´»å‹•èˆ‰è¾¦å»ºè­°</li></ul>
                    </div>
                    <div class="guide-card" style="border-left: 4px solid #94a3b8;">
                        <h4><i class="fa-solid fa-gavel"></i> å¸æ³•é‡‹æ†²</h4>
                        <p style="font-size:0.85rem; margin-bottom:10px; font-weight:bold;">è² è²¬å–®ä½ï¼šè§£é‡‹å§”å“¡æœƒ</p>
                        <ul><li>æ³•è¦ç–‘ç¾©è§£é‡‹</li><li>è‡ªæ²»æ³•è¦é•æ†²å¯©æŸ¥</li><li>é¸èˆ‰ç³¾ç´›ä»²è£</li></ul>
                    </div>
                </div>
                <div style="margin-top:30px;">
                    <a href="https://forms.gle/5ymGZKDaAyriEBubA" target="_blank" class="btn btn-blue" style="padding: 15px 30px; font-size: 1rem; width:100%; max-width:300px; justify-content:center;">
                        <i class="fa-solid fa-pen-to-square"></i> é»æ­¤å¡«å¯«ç·šä¸Šææ¡ˆå–®
                    </a>
                </div>
            </div>
        </div>
    </section>

    <div class="admin-dock">
        <button id="loginBtn" class="btn btn-blue" onclick="openModal('loginModal')" style="display: flex;"><i class="fa-solid fa-user-gear"></i> ç®¡ç†ç™»å…¥</button>
        <button class="btn btn-gray admin-only" onclick="openAdminManager()"><i class="fa-solid fa-users-gear"></i> è¨­å®š</button>
        <button class="btn btn-green admin-only" onclick="exportHTML()"><i class="fa-solid fa-download"></i> å„²å­˜</button>
        <button class="btn btn-red admin-only" onclick="logout()"><i class="fa-solid fa-right-from-bracket"></i> ç™»å‡º</button>
    </div>

    <div id="loginModal" class="overlay" style="display: none;">
        <div class="modal">
            <h3 style="margin-bottom:15px; font-size:1.5rem;">å¾Œå°æ¬Šé™é©—è­‰</h3>
            <input type="text" id="uid" placeholder="è«‹è¼¸å…¥å¸³è™Ÿ">
            <input type="password" id="pwd" placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-blue" style="flex:1; justify-content:center;" onclick="login()">ç™»å…¥</button>
                <button class="btn btn-red" style="flex:1; justify-content:center;" onclick="closeModal('loginModal')">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <div id="adminManagerModal" class="overlay" style="display: none;">
        <div class="modal">
            <h3>ç®¡ç†å“¡å¸³è™Ÿè¨­å®š</h3>
            <p style="color:#64748b; font-size:0.9rem; margin-bottom:15px;">è®Šæ›´å¾Œè«‹å‹™å¿…ä¸‹è¼‰æ–°æª”æ¡ˆã€‚</p>
            <div id="adminListContainer" style="margin-bottom:20px; text-align:left;"><div class="admin-list-item"><span><i class="fa-solid fa-user"></i> s11311092</span><button class="btn-red" style="padding: 5px 10px; font-size: 0.8rem;" onclick="removeAdmin(0)">åˆªé™¤</button></div><div class="admin-list-item"><span><i class="fa-solid fa-user"></i> s123456789</span><button class="btn-red" style="padding: 5px 10px; font-size: 0.8rem;" onclick="removeAdmin(1)">åˆªé™¤</button></div></div>
            <hr style="margin:15px 0; border:0; border-top:1px solid #e2e8f0;">
            <h4 style="margin-bottom:10px;">æ–°å¢ç®¡ç†å“¡</h4>
            <input type="text" id="newAdminId" placeholder="æ–°å¸³è™Ÿ">
            <input type="password" id="newAdminPwd" placeholder="æ–°å¯†ç¢¼">
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-green" style="flex:1; justify-content:center;" onclick="addAdmin()">æ–°å¢</button>
                <button class="btn btn-gray" style="flex:1; justify-content:center;" onclick="closeModal('adminManagerModal')">é—œé–‰</button>
            </div>
        </div>
    </div>

    <div id="fileModal" class="overlay" style="display: none;">
        <div class="modal">
            <h3>æ–°å¢æ–‡ä»¶é€£çµ</h3>
            <input type="text" id="fileName" placeholder="é¡¯ç¤ºåç¨±">
            <input type="text" id="fileUrl" placeholder="é€£çµç¶²å€">
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-blue" style="flex:1; justify-content:center;" onclick="confirmAddFile()">åŠ å…¥</button>
                <button class="btn btn-gray" style="flex:1; justify-content:center;" onclick="closeModal('fileModal')">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <div id="billModal" class="overlay" style="display: none;">
        <div class="modal">
            <h3>æ–°å¢æ³•æ¡ˆ</h3>
            <input type="text" id="bNo" placeholder="æ¡ˆè™Ÿ (ä¾‹: 113-A-01)">
            <input type="text" id="bTitle" placeholder="æ³•æ¡ˆåç¨±">
            <input type="text" id="bDept" placeholder="ææ¡ˆå–®ä½">
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-blue" style="flex:1; justify-content:center;" onclick="addBill()">ç¢ºèª</button>
                <button class="btn btn-gray" style="flex:1; justify-content:center; background:#cbd5e1;" onclick="closeModal('billModal')">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <div id="scheduleInputModal" class="overlay" style="display: none;">
        <div class="modal">
            <h3>æ–°å¢è¡Œç¨‹</h3>
            <label style="display:block; text-align:left; font-size:0.9rem; color:#64748b; margin-top:10px;">æ´»å‹•æ¨™é¡Œ</label>
            <input type="text" id="schTitle" placeholder="ä¾‹ï¼šç­ä»£å¤§æœƒå®šæœŸæœƒ">
            
            <label style="display:block; text-align:left; font-size:0.9rem; color:#64748b;">æ—¥æœŸ (é»é¸æœˆæ—¥)</label>
            <input type="date" id="schDate">

            <div style="display:flex; gap:10px;">
                <div style="flex:1">
                    <label style="display:block; text-align:left; font-size:0.9rem; color:#64748b;">æ™‚é–“</label>
                    <input type="text" id="schTime" placeholder="ä¾‹ï¼š12:10 - 13:00">
                </div>
                <div style="flex:1">
                    <label style="display:block; text-align:left; font-size:0.9rem; color:#64748b;">åœ°é»</label>
                    <input type="text" id="schLoc" placeholder="ä¾‹ï¼š3F æœƒè­°å®¤">
                </div>
            </div>

            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-blue" style="flex:1; justify-content:center;" onclick="confirmAddSchedule()">æ–°å¢</button>
                <button class="btn btn-gray" style="flex:1; justify-content:center;" onclick="closeModal('scheduleInputModal')">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <div id="infoModal" class="overlay" onclick="closeModal('infoModal')" style="display: none;">
        <div class="modal" onclick="event.stopPropagation()">
            <h2 id="infoTitle" style="color:var(--accent); margin-bottom:10px;">ç­è¯æœƒ</h2>
            <hr style="border:0; border-top:1px solid #eee; margin:10px 0;">
            <p id="infoDesc" style="text-align:left; line-height:1.8; color:#475569; margin-top:15px;">ç­è¯æœƒï¼šæœ€é«˜è¡Œæ”¿æ©Ÿé—œï¼Œæ¨å‹•å­¸ç”Ÿç¦åˆ©èˆ‡è¾¦ç†å…¨æ ¡æ€§æ´»å‹•ã€‚</p>
            <button class="btn btn-blue" style="width:100%; justify-content:center; margin-top:20px;" onclick="closeModal('infoModal')">é—œé–‰</button>
        </div>
    </div>

    <script>
        let ADMIN_DB = [];
        let currentFileTarget = null;
        let currentDateEditTarget = null;

        const INFO_DB = {
            'leg': 'ç­ä»£å¤§æœƒï¼šæœ€é«˜æ°‘æ„æ©Ÿé—œï¼Œç”±å…¨æ ¡ç­ä»£çµ„æˆï¼Œå¯©è­°æ³•è¦èˆ‡é ç®—ã€‚',
            'leg-leader': '<b>è­°é•·ã€å‰¯è­°é•·</b><br>ä¸»æŒç­ç´šä»£è¡¨å¤§æœƒå„é …æœƒè­°ï¼Œç¶­æŒè­°äº‹ç¨‹åºä¹‹æ­£ç•¶èˆ‡ç§©åºã€‚',
            'leg-sec': '<b>ç§˜æ›¸è™•</b><br>è² è²¬æœƒå‹™çµ±æ•´èˆ‡è¡Œæ”¿åº¶å‹™è¦åŠƒï¼Œå½™æ•´å„é …æœƒè­°è³‡æ–™èˆ‡æ±ºè­°äº‹é …ã€‚',
            'exe': 'ç­è¯æœƒï¼šæœ€é«˜è¡Œæ”¿æ©Ÿé—œï¼Œæ¨å‹•å­¸ç”Ÿç¦åˆ©èˆ‡è¾¦ç†å…¨æ ¡æ€§æ´»å‹•ã€‚',
            'exe-leader': '<b>ç­è¯æœƒä¸»å¸­</b><br>ç¶œç†å­¸ç”Ÿè‡ªæ²»è¡Œæ”¿äº‹å‹™ï¼Œçµ±ç±Œæ”¿ç­–è¦åŠƒèˆ‡åŸ·è¡Œã€‚<br><br><b>ç­è¯æœƒå‰¯ä¸»å¸­</b><br>è¥„åŠ©ä¸»å¸­ç£å°å„çµ„æ¥­å‹™é‹ä½œã€‚',
            'exe-dept': '<b>å­¸æ¬ŠåŠè¡Œæ”¿äº”çµ„</b><br>åŒ…å«å­¸æ¬Šã€æ–‡æ›¸ã€å…¬é—œã€æ´»å‹•ã€æ©Ÿå‹•ç­‰éƒ¨é–€ï¼Œå„å¸å…¶è·æ¨å‹•å­¸ç”Ÿäº‹å‹™ã€‚',
            'jud': 'è§£é‡‹å§”å“¡æœƒï¼šæœ€é«˜å¸æ³•æ©Ÿé—œï¼Œè§£é‡‹æ³•è¦ç–‘ç¾©ä¸¦è§£æ±ºæ¬Šé™è¡çªã€‚',
            'jud-comm': '<b>å¸æ³•å¬é›†äººèˆ‡å§”å“¡</b><br>è² è²¬ç« ç¨‹è§£é‡‹èˆ‡çˆ­è­°æ¡ˆä»¶å¯©ç†ï¼Œä¿éšœå­¸ç”Ÿæ¬Šç›Šã€‚',
            'jud-ele': '<b>é¸èˆ‰å§”å“¡æœƒ</b><br>ä¾æ³•è¾¦ç†å­¸ç”Ÿè‡ªæ²»å„é …é¸èˆ‰äº‹å‹™ï¼Œç¢ºä¿é¸èˆ‰å…¬å¹³ã€‚'
        };

        const ENG_MONTHS = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
        const CHI_DAYS = ["é€±æ—¥", "é€±ä¸€", "é€±äºŒ", "é€±ä¸‰", "é€±å››", "é€±äº”", "é€±å…­"];

        function init() {
            const dbContent = document.getElementById('db-admins').innerText;
            try { ADMIN_DB = JSON.parse(dbContent); } catch(e) { ADMIN_DB = [{u:'s11311092', p:'JA6300010'}]; }
        }

        function toggleMenu() { document.getElementById('navLinks').classList.toggle('active'); }

        function login() {
            const u = document.getElementById('uid').value;
            const p = document.getElementById('pwd').value;
            if(ADMIN_DB.some(admin => admin.u === u && admin.p === p)) {
                document.body.classList.add('is-admin');
                toggleEditable(true);
                document.getElementById('loginBtn').style.display = 'none';
                closeModal('loginModal');
                document.getElementById('uid').value = ''; document.getElementById('pwd').value = '';
                alert('âœ… ç®¡ç†æ¨¡å¼å·²é–‹å•Ÿ');
            } else { alert('âŒ å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤'); }
        }

        function logout() {
            if(confirm('ç¢ºå®šè¦é€€å‡ºç®¡ç†æ¨¡å¼å—ï¼Ÿæœªä¸‹è¼‰çš„è®Šæ›´å°‡æœƒéºå¤±ã€‚')) {
                document.body.classList.remove('is-admin');
                toggleEditable(false);
                document.getElementById('loginBtn').style.display = 'flex';
                alert('ğŸ”’ å·²å›åˆ°è¨ªå®¢è¦–è§’');
            }
        }

        function toggleEditable(isEditable) {
            // é™¤äº†æ—¥æœŸå€å¡Šå¤–çš„å¯ç·¨è¼¯å…ƒç´ 
            document.querySelectorAll('.can-edit:not(.schedule-date-box)').forEach(el => {
                if(el.parentElement.tagName !== 'H3' && !el.classList.contains('schedule-date-box')) {
                    el.contentEditable = isEditable;
                }
            });
            document.querySelectorAll('h3.can-edit').forEach(h3 => h3.contentEditable = isEditable);
        }

        function showInfo(key) {
            if(document.body.classList.contains('is-admin')) return;
            let titleEl = document.querySelector(`[onclick="showInfo('${key}')"] strong`);
            if(!titleEl) return;
            document.getElementById('infoTitle').innerHTML = titleEl.innerHTML;
            document.getElementById('infoDesc').innerHTML = INFO_DB[key] || 'è©³æƒ…è«‹è¦‹å­¸ç”Ÿè‡ªæ²»æ³•ã€‚';
            openModal('infoModal');
        }

        function openModal(id) { document.getElementById(id).style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        // --- ç®¡ç†å“¡è¨­å®š ---
        function openAdminManager() { renderAdminList(); openModal('adminManagerModal'); }
        function renderAdminList() {
            const container = document.getElementById('adminListContainer');
            container.innerHTML = '';
            ADMIN_DB.forEach((admin, index) => {
                const item = document.createElement('div');
                item.className = 'admin-list-item';
                item.innerHTML = `<span><i class="fa-solid fa-user"></i> ${admin.u}</span><button class="btn-red" style="padding: 5px 10px; font-size: 0.8rem;" onclick="removeAdmin(${index})">åˆªé™¤</button>`;
                container.appendChild(item);
            });
        }
        function addAdmin() {
            const u = document.getElementById('newAdminId').value.trim();
            const p = document.getElementById('newAdminPwd').value.trim();
            if(!u || !p) { alert('è«‹è¼¸å…¥å®Œæ•´'); return; }
            if(ADMIN_DB.some(a => a.u === u)) { alert('å¸³è™Ÿå·²å­˜åœ¨'); return; }
            ADMIN_DB.push({u: u, p: p});
            updateDbElement(); renderAdminList();
            document.getElementById('newAdminId').value = ''; document.getElementById('newAdminPwd').value = '';
        }
        function removeAdmin(index) {
            if(ADMIN_DB.length <= 1) { alert('è‡³å°‘ä¿ç•™ä¸€å€‹'); return; }
            if(confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) { ADMIN_DB.splice(index, 1); updateDbElement(); renderAdminList(); }
        }
        function updateDbElement() { document.getElementById('db-admins').innerText = JSON.stringify(ADMIN_DB); }

        // --- æŠ•ç¥¨è¨ˆç®— ---
        function calcVotes(el) {
            const card = el.closest('.meeting-card');
            const pro = parseInt(card.querySelector('.v-pro').innerText) || 0;
            const con = parseInt(card.querySelector('.v-con').innerText) || 0;
            const abs = parseInt(card.querySelector('.v-abs').innerText) || 0;
            const total = pro + con + abs;
            if (total > 0) {
                const pp = Math.round((pro/total)*100), pc = Math.round((con/total)*100), pa = 100 - pp - pc;
                card.querySelector('.bar-pro').style.width = pp + '%'; card.querySelector('.bar-con').style.width = pc + '%'; card.querySelector('.bar-abs').style.width = pa + '%';
                card.querySelector('.p-pro').innerText = pp; card.querySelector('.p-con').innerText = pc; card.querySelector('.p-abs').innerText = pa;
            }
        }

        // --- æ–°å¢é …ç›® ---
        function addBill() {
            const no = document.getElementById('bNo').value;
            const title = document.getElementById('bTitle').value;
            const dept = document.getElementById('bDept').value;
            const html = `<tr><td class="can-edit is-admin">${no}</td><td class="can-edit is-admin">${title}</td><td class="can-edit is-admin">${dept}</td><td><span class="status-badge can-edit is-admin" style="background:#ddd;">è‰æ¡ˆ</span></td><td><div class="files-container"></div><button class="btn-light admin-only" style="margin-top:5px; padding:2px 8px; font-size:0.7rem;" onclick="addFile(this, 'bill')"><i class="fa-solid fa-plus"></i> é€£çµ</button></td><td class="admin-only"><button class="btn-red" style="padding:5px 10px;" onclick="this.closest('tr').remove()">åˆªé™¤</button></td></tr>`;
            document.getElementById('billBody').insertAdjacentHTML('beforeend', html);
            if(document.body.classList.contains('is-admin')) toggleEditable(true);
            closeModal('billModal');
        }

        function addMeeting() {
            const html = `<div class="meeting-card"><h3 class="can-edit is-admin">æ–°æœƒè­°ä¸»é¡Œ</h3><p style="margin:10px 0;">ğŸ“ åœ°é»ï¼š<span class="can-edit is-admin">å¾…å®š</span></p><p>â° æ™‚é–“ï¼š<span class="can-edit is-admin">å¾…å®š</span></p><div class="vote-box"><div class="vote-inputs"><span style="color:var(--success)">è´Šæˆ <span class="vote-num can-edit v-pro" oninput="calcVotes(this)">0</span></span><span style="color:var(--danger)">åå° <span class="vote-num can-edit v-con" oninput="calcVotes(this)">0</span></span><span style="color:#64748b">æ£„æ¬Š <span class="vote-num can-edit v-abs" oninput="calcVotes(this)">0</span></span></div><div class="progress-bar"><div class="bar-segment bar-pro" style="width:0; background:var(--success)"></div><div class="bar-segment bar-con" style="width:0; background:var(--danger)"></div><div class="bar-segment bar-abs" style="width:0; background:#94a3b8"></div></div><div style="text-align:right; font-size:0.8rem; margin-top:5px; color:#64748b;">å³æ™‚æ¯”ä¾‹ï¼š<span class="p-pro">0</span>% / <span class="p-con">0</span>% / <span class="p-abs">0</span>%</div></div><div class="file-list"><small style="display:block; color:#94a3b8; margin-bottom:5px;">ğŸ“‚ ç›¸é—œæœƒè­°è³‡æ–™ï¼š</small><div class="files-container"></div><button class="btn-light admin-only" style="margin-top:10px; padding:5px 15px; font-size:0.8rem;" onclick="addFile(this, 'meeting')"><i class="fa-solid fa-paperclip"></i> æ–°å¢é™„ä»¶é€£çµ</button></div><button class="btn-red admin-only" style="margin-top:15px; width:100%; justify-content:center;" onclick="this.closest('.meeting-card').remove()">åˆªé™¤ç´€éŒ„</button></div>`;
            document.getElementById('meetingGrid').insertAdjacentHTML('beforeend', html);
            if(document.body.classList.contains('is-admin')) toggleEditable(true);
        }

        // --- è¡Œç¨‹èˆ‡æ—¥æœŸè™•ç† ---
        
        function openScheduleModal() {
            document.getElementById('schTitle').value = '';
            document.getElementById('schDate').value = '';
            document.getElementById('schTime').value = '';
            document.getElementById('schLoc').value = '';
            openModal('scheduleInputModal');
        }

        function confirmAddSchedule() {
            const title = document.getElementById('schTitle').value || 'æ–°è¡Œç¨‹';
            const dateVal = document.getElementById('schDate').value;
            const time = document.getElementById('schTime').value || 'æ™‚é–“å¾…å®š';
            const loc = document.getElementById('schLoc').value || 'åœ°é»å¾…å®š';

            let m = 'MTH', d = '00', w = 'é€±?';
            if(dateVal) {
                const dateObj = new Date(dateVal);
                m = ENG_MONTHS[dateObj.getMonth()];
                d = dateObj.getDate();
                w = CHI_DAYS[dateObj.getDay()];
            }

            const html = `
            <div class="schedule-card">
                <div class="schedule-date-box" style="background: var(--primary);" onclick="editScheduleDate(this)">
                    <span class="date-month">${m}</span>
                    <span class="date-day">${d}</span>
                    <span class="date-weekday">${w}</span>
                </div>
                <div class="schedule-content">
                    <h3 class="can-edit is-admin" style="font-size:1.2rem; margin-bottom:5px;">${title}</h3>
                    <div class="schedule-info">
                        <span><i class="fa-regular fa-clock"></i> <span class="can-edit is-admin">${time}</span></span>
                        <span><i class="fa-solid fa-location-dot"></i> <span class="can-edit is-admin">${loc}</span></span>
                    </div>
                    <div class="files-container"></div>
                    <button class="btn-light admin-only" style="margin-top:10px; padding:5px 15px; font-size:0.8rem; width:fit-content;" onclick="addFile(this, 'schedule')"><i class="fa-solid fa-link"></i> é€£çµ</button>
                    <button class="btn-red admin-only" style="margin-top:10px; margin-left:10px; padding:5px 15px; font-size:0.8rem; width:fit-content;" onclick="this.closest('.schedule-card').remove()">åˆªé™¤</button>
                </div>
            </div>`;
            document.getElementById('scheduleGrid').insertAdjacentHTML('beforeend', html);
            if(document.body.classList.contains('is-admin')) toggleEditable(true);
            closeModal('scheduleInputModal');
        }

        // é»æ“Šæ—¥æœŸå€å¡Šä¿®æ”¹æ—¥æœŸ
        function editScheduleDate(el) {
            if(!document.body.classList.contains('is-admin')) return;
            currentDateEditTarget = el;
            const picker = document.getElementById('hiddenDatePicker');
            picker.showPicker(); // ç¾ä»£ç€è¦½å™¨åŸç”Ÿ API
        }

        function applyDateChange(picker) {
            if(!currentDateEditTarget || !picker.value) return;
            const dateObj = new Date(picker.value);
            currentDateEditTarget.querySelector('.date-month').innerText = ENG_MONTHS[dateObj.getMonth()];
            currentDateEditTarget.querySelector('.date-day').innerText = dateObj.getDate();
            currentDateEditTarget.querySelector('.date-weekday').innerText = CHI_DAYS[dateObj.getDay()];
            picker.value = ''; // Reset
        }

        // --- æª”æ¡ˆé€£çµè™•ç† ---
        function addFile(btn, type) {
            currentFileTarget = btn.previousElementSibling; 
            document.getElementById('fileName').value = '';
            document.getElementById('fileUrl').value = '';
            openModal('fileModal');
        }

        function confirmAddFile() {
            const name = document.getElementById('fileName').value || 'æ–‡ä»¶';
            let url = document.getElementById('fileUrl').value || '#';
            if(url !== '#' && !url.startsWith('http')) url = 'https://' + url;

            const fileHTML = `<a href="${url}" target="_blank" class="file-tag"><i class="fa-regular fa-file"></i> ${name}</a>`;
            if(currentFileTarget) currentFileTarget.insertAdjacentHTML('beforeend', fileHTML);
            closeModal('fileModal');
        }

        // --- è¼¸å‡º ---
        function exportHTML() {
            updateDbElement();
            let clone = document.documentElement.cloneNode(true);
            clone.querySelectorAll('.overlay').forEach(e => e.style.display = 'none');
            clone.querySelector('.nav-links').classList.remove('active');
            clone.querySelector('body').classList.remove('is-admin');
            
            // ç§»é™¤ç·¨è¼¯å±¬æ€§
            clone.querySelectorAll('[contenteditable]').forEach(e => e.removeAttribute('contenteditable'));
            clone.querySelectorAll('.can-edit').forEach(e => e.classList.remove('can-edit')); // ç‚ºäº†ä¹¾æ·¨è¼¸å‡º
            
            // æ¢å¾©ç®¡ç†æŒ‰éˆ•
            if(clone.querySelector('#loginBtn')) clone.querySelector('#loginBtn').style.display = 'flex';
            
            const blob = new Blob(["<!DOCTYPE html>\n" + clone.outerHTML], {type: 'text/html'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'index.html';
            a.click();
            alert('âœ… ç¶²é å·²æ›´æ–°ï¼è«‹å°‡ä¸‹è¼‰çš„ index.html ä¸Šå‚³ã€‚');
            
            // æ¢å¾©ç•¶å‰é é¢çš„ç·¨è¼¯ç‹€æ…‹ä»¥å…ä½¿ç”¨è€…ä»¥ç‚ºå£äº†
            if(document.body.classList.contains('is-admin')) {
                document.querySelectorAll('.can-edit').forEach(el => el.contentEditable = true);
            }
        }
    </script>

</body></html>